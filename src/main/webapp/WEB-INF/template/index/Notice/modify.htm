<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<#include "../Public/common.inc.htm">
<#include "../Public/resource.inc.htm">
<script src="${Web_projectHome}/api/KindEditor/kindeditor-all-min.js" language="javascript"></script>
<#if empty((_ASSIGN_.notice.id)!0)>
<form id="submitForm" method="post" action="<@url action="insert" />">
<#else>
<form id="submitForm" method="post" action="<@url action="update" />">
<input type="hidden" name="id" value="${(_ASSIGN_.notice.id)!0}" />
</#if>
<table cellspacing="1" cellpadding="0" class="lineTable tdLeft">
	<tr>
		<th class="width130">标题</th>
		<td>
			<input class="easyui-validatebox inputText length430" type="text" name="notice.title" data-options="required:true" value="${(_ASSIGN_.notice.title)!""}" />
		</td>
	</tr>
	<tr>
		<th>排序</th>
		<td>
			<input class="easyui-numberspinner inputText" type="text" name="notice.sort" data-options="required:true,min:0" value="${(_ASSIGN_.notice.sort)!0}" />
		</td>
	</tr>
	<tr>
		<th>类型</th>
		<td>
			<select id="role" class="easyui-combobox length200" data-options="editable:false" name="notice.type.id">
				<@getOptionList seq=_ASSIGN_.type default=_ASSIGN_.tid!0 tips="请选择类型" />
			</select>
		</td>
	</tr>
	<tr>
		<th>对象</th>
		<td>默认全体成员可见</td>
	</tr>
	<tr>
		<th>组织</th>
		<td>
			<span class="showText">${(_ASSIGN_.notice.organizeText)!""}</span>
			<a href="javascript:void(0);" class="easyui-linkbutton selectOrganize" iconcls="icon-edit" plain="true"></a>
			<input class="selectIds" type="hidden" name="notice.organizeIds" value="${(_ASSIGN_.notice.organizeIds)!""}" />
			<input class="selectText" type="hidden" name="notice.organizeText" value="${(_ASSIGN_.notice.organizeText)!""}" />
		</td>
	</tr>
	<tr>
		<th>角色</th>
		<td>
			<span class="showText">${(_ASSIGN_.notice.roleText)!""}</span>
			<a href="javascript:void(0);" class="easyui-linkbutton selectRole" iconcls="icon-edit" plain="true"></a>
			<input class="selectIds" type="hidden" name="notice.roleIds" value="${(_ASSIGN_.notice.roleIds)!""}" />
			<input class="selectText" type="hidden" name="notice.roleText" value="${(_ASSIGN_.notice.roleText)!""}" />
		</td>
	</tr>
	<tr>
		<th>用户</th>
		<td>
			<span class="showText">${(_ASSIGN_.notice.memberText)!""}</span>
			<a href="javascript:void(0);" class="easyui-linkbutton selectMember" iconcls="icon-edit" plain="true"></a>
			<input class="selectIds" type="hidden" name="notice.memberIds" value="${(_ASSIGN_.notice.memberIds)!""}" />
			<input class="selectText" type="hidden" name="notice.memberText" value="${(_ASSIGN_.notice.memberText)!""}" />
		</td>
	</tr>
	<tr>
		<th>排除</th>
		<td>
			<span class="showText">${(_ASSIGN_.notice.exceptText)!""}</span>
			<a href="javascript:void(0);" class="easyui-linkbutton selectMember" iconcls="icon-edit" plain="true"></a>
			<input class="selectIds" type="hidden" name="notice.exceptIds" value="${(_ASSIGN_.notice.exceptIds)!""}" />
			<input class="selectText" type="hidden" name="notice.exceptText" value="${(_ASSIGN_.notice.exceptText)!""}" />
		</td>
	</tr>
	<tr>
		<th>内容</th>
		<td class="editor">
			<textarea name="notice.content" class="w668h280">${(_ASSIGN_.notice.content)!""}</textarea>
		</td>
	</tr>
	<tr>
		<th>操作</th>
		<td>
			<a id="buttonOk" href="javascript:void(0);" class="easyui-linkbutton" data-options="iconCls:'icon-ok'">确定</a>
			<a id="buttonCancel" href="javascript:void(0);" class="easyui-linkbutton" data-options="iconCls:'icon-cancel'">重置</a>
		</td>
	</tr>
</table>
</form>
<#include "../Organize/select.inc.htm">
<#include "../Role/select.inc.htm">
<#include "../Member/select.inc.htm">
<script>
$(function () {
	var contentEditor = KindEditor.create('textarea[name="notice.content"]');
	$('#submitForm').form({
		success : function (data) {
			data = $.parseJSON(data);
			if(data.status) {
				Web_alertInfo(data.message);
				$('#buttonOk').linkbutton('enable');
			} else {
				Web_redirectPage(data.message);
			}
		}
	});
	$('#buttonOk').bind('click', function () {
		$('textarea[name="notice.content"]').html(contentEditor.html());
		$(this).linkbutton('disable');
		$('#submitForm').submit();
	});
	$('#buttonCancel').bind('click', function () {
		$('#submitForm')[0].reset();
	});
});
</script>